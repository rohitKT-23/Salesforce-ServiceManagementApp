<template>
    <lightning-card title="Approval Steps" icon-name="standard:approval" if:true={hasSteps}>
        <div class="slds-p-around_medium">
            <template if:true={isLoading}>
                <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
            </template>
            
            <template if:false={isLoading}>
                <template if:true={error}>
                    <div class="slds-text-color_error slds-m-bottom_medium">
                        {error}
                    </div>
                </template>
                
                <ul class="slds-timeline" if:true={hasSteps}>
                    <template for:each={stepsWithClasses} for:item="step">
                        <li key={step.id} class={step.statusClass}>
                            <div class="slds-timeline__item">
                                <span class="slds-assistive-text">{step.statusLabel}</span>
                                <div class="slds-media">
                                    <div class="slds-media__figure">
                                        <lightning-icon
                                            icon-name={step.icon}
                                            variant={step.iconVariant}
                                            size="small">
                                        </lightning-icon>
                                    </div>
                                    <div class="slds-media__body">
                                        <div class="slds-timeline__actions">
                                            <dl class="slds-list_horizontal slds-wrap">
                                                <dt class="slds-item_label slds-text-color_weak slds-truncate" title="Sequence">
                                                    Step {step.sequence}
                                                </dt>
                                                <dd class="slds-item_detail slds-truncate">
                                                    <lightning-badge 
                                                        label={step.statusLabel}
                                                        class="slds-m-left_x-small">
                                                    </lightning-badge>
                                                </dd>
                                            </dl>
                                        </div>
                                        <h3 class="slds-timeline__title slds-truncate" title={step.description}>
                                            {step.description}
                                        </h3>
                                        <p class="slds-timeline__detail">
                                            <template if:true={step.expectedStatus}>
                                                Expected Status: <strong>{step.expectedStatus}</strong>
                                            </template>
                                            <template if:true={step.currentStatus}>
                                                <br/>Current Status: <strong>{step.currentStatus}</strong>
                                            </template>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </template>
                </ul>
            </template>
        </div>
    </lightning-card>
</template>

